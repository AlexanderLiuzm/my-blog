<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>字典是什么 | 一起来学VBA</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/my-blog/assets/css/0.styles.60ba14cb.css" as="style"><link rel="preload" href="/my-blog/assets/js/app.2986e5e9.js" as="script"><link rel="preload" href="/my-blog/assets/js/2.16fc4d87.js" as="script"><link rel="preload" href="/my-blog/assets/js/5.df6d08e9.js" as="script"><link rel="prefetch" href="/my-blog/assets/js/10.7b242d11.js"><link rel="prefetch" href="/my-blog/assets/js/11.e8193104.js"><link rel="prefetch" href="/my-blog/assets/js/12.42ae7acd.js"><link rel="prefetch" href="/my-blog/assets/js/13.2d325377.js"><link rel="prefetch" href="/my-blog/assets/js/14.f55b1da8.js"><link rel="prefetch" href="/my-blog/assets/js/15.6dbc8e41.js"><link rel="prefetch" href="/my-blog/assets/js/16.4f6d5025.js"><link rel="prefetch" href="/my-blog/assets/js/17.b34fcedc.js"><link rel="prefetch" href="/my-blog/assets/js/18.8cbade4a.js"><link rel="prefetch" href="/my-blog/assets/js/19.87ee01fa.js"><link rel="prefetch" href="/my-blog/assets/js/20.14ca77d3.js"><link rel="prefetch" href="/my-blog/assets/js/21.ed2350eb.js"><link rel="prefetch" href="/my-blog/assets/js/22.94f96a8d.js"><link rel="prefetch" href="/my-blog/assets/js/23.132b82a4.js"><link rel="prefetch" href="/my-blog/assets/js/24.4de088b5.js"><link rel="prefetch" href="/my-blog/assets/js/25.1e8b475b.js"><link rel="prefetch" href="/my-blog/assets/js/3.01ded201.js"><link rel="prefetch" href="/my-blog/assets/js/4.a07cd685.js"><link rel="prefetch" href="/my-blog/assets/js/6.ffa81f48.js"><link rel="prefetch" href="/my-blog/assets/js/7.88812301.js"><link rel="prefetch" href="/my-blog/assets/js/8.9efc655e.js"><link rel="prefetch" href="/my-blog/assets/js/9.3468bdcf.js">
    <link rel="stylesheet" href="/my-blog/assets/css/0.styles.60ba14cb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-blog/" class="home-link router-link-active"><!----> <span class="site-name">一起来学VBA</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-blog/" class="nav-link">主页</a></div><div class="nav-item"><a href="/my-blog/vba_entry/" class="nav-link">Excel VBA</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="热门文章" class="dropdown-title"><span class="title">热门文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/vba_entry/ExcelVBA基本语法规则/" class="nav-link">VBA基本语法</a></li><li class="dropdown-item"><!----> <a href="/my-blog/vba_middle/利用ExcelVBA字典删除重复项/" class="nav-link">VBA字典的应用</a></li><li class="dropdown-item"><!----> <a href="/my-blog/vba_middle/二维表转一维表/" class="nav-link">二维表转一维表</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/AlexanderLiuzm" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-blog/" class="nav-link">主页</a></div><div class="nav-item"><a href="/my-blog/vba_entry/" class="nav-link">Excel VBA</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="热门文章" class="dropdown-title"><span class="title">热门文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/vba_entry/ExcelVBA基本语法规则/" class="nav-link">VBA基本语法</a></li><li class="dropdown-item"><!----> <a href="/my-blog/vba_middle/利用ExcelVBA字典删除重复项/" class="nav-link">VBA字典的应用</a></li><li class="dropdown-item"><!----> <a href="/my-blog/vba_middle/二维表转一维表/" class="nav-link">二维表转一维表</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/AlexanderLiuzm" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/my-blog/vba_entry/" class="sidebar-link">初级</a></li><li><a href="/my-blog/vba_middle/" class="sidebar-link">中级</a></li><li><a href="/my-blog/vba_high/" class="sidebar-link">高级</a></li><li><a href="/my-blog/" class="sidebar-link">首页</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="字典是什么"><a href="#字典是什么" class="header-anchor">#</a> 字典是什么</h1> <p><img src="/my-blog/assets/img/VBA_Dict_2.86438b94.jpg" alt="解释"> <img src="/my-blog/assets/img/VBA_Dict_3.5887cc2f.jpg" alt="图片解释"></p> <h1 id="如何使用字典删除重复项"><a href="#如何使用字典删除重复项" class="header-anchor">#</a> 如何使用字典删除重复项</h1> <p><img src="/my-blog/assets/img/VBA_Dict_4.4f258641.jpg" alt="分开四步走"></p> <h1 id="两种方法的区别"><a href="#两种方法的区别" class="header-anchor">#</a> 两种方法的区别</h1> <p>两种方法最大的差别就是<strong>是否直接对单元格进行删除操作</strong>。
<code>字典</code>并不会直接对单元格进行删除操作，我们仅仅是利用字典只能保存唯一值的特点进行中间过渡，把所有唯一值都保存到字典数组中去，然后再把字典中的唯一值输出赋值给单元格。我们进行的操作仅仅是写入和赋值。
<code>Excel删除重复项函数</code>则是一次次循环对比，对满足条件的行进行<code>删除行</code>的处理，而不仅仅是对字符串的读写了。
<img src="/my-blog/assets/img/VBA_Dict_5.bb6a058b.jpg" alt="两种方法的比较">
相对来说，<code>字典</code>比<code>Excel删除重复项</code>操作要更快，更有效率一些。这是为什么呢？主要是因为对字符串的处理只是文字级别上的，而对单元格的删除处理已经达到窗口级别。（好吧，我承认这是我编的，我自己这么理解，反正对单元格的操作层级更高，需要更多的计算和处理）计算机对操作字符串会更在行，更有效率。</p> <p>最后贴上这次完成的代码：</p> <div class="language- extra-class"><pre class="language-text"><code>Sub test()
'声明各种变量
Dim dic As Object
Dim i As Integer
Dim s As String
Dim rw
Dim col
'因为后期会多次使用到usedrange对象的行数和列数，所以就先创建变量，精简后期冗长的代码
rw = ActiveSheet.UsedRange.Rows.Count
col = ActiveSheet.UsedRange.col.Count
'创建字典对象的语句
Set dic = CreateObject(&quot;scripting.dictionary&quot;)
'建立循环
For i = 2 To rw
    '用join函数把一行中的所有数值拼成一个字符串，join函数的参数是一个数组
    '然而因为一行的数据并不是一个数组，所以我们用index函数把一行的数值转成一个一维数组（当然用transpose函数也是可以的）
    'Index函数的对象是二维的区域，所以我们给结束的单元格行号加1，让整个对象变成两行多列的二维区域
    '再写上第二个参数1，表示提取第一行的数值
    s = VBA.Join(WorksheetFunction.Index(Range(Cells(i, 1), Cells(i + 1, col)).Value, 1))
    '把一整行的数据作为item，方便在最后的时候给单元格赋值进行还原
    dic(s) = Range(Cells(i, 1), Cells(i, col))
Next i

'声明一个数组，并把已经经过字典处理的唯一值赋值（即唯一的数据行）给他
Dim arr2()
arr2 = dic.items
'数据行是一个二维区域无法进行赋值，使用两次transpose进行转制（数组转成字符串，再转成一个个单独的数值）之后赋值给原来从第二行开始的区域
Range(Cells(2, 1), Cells(dic.Count + 1, col)) = WorksheetFunction.Transpose(WorksheetFunction.Transpose(arr2))
'明显经过上述的处理之后只有字典里的那么多行数据还原给了表格中的单元格
'然而原有的数据是多于字典里的数据的，所以在dic.count+1行下面还有原先的数据
'使用clear函数把这些多余的数据清除
Range(Cells(dic.Count + 2, 1), Cells(rw, col)).Clear

End Sub
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/my-blog/assets/js/app.2986e5e9.js" defer></script><script src="/my-blog/assets/js/2.16fc4d87.js" defer></script><script src="/my-blog/assets/js/5.df6d08e9.js" defer></script>
  </body>
</html>
