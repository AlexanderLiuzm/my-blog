(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{210:function(n,e,r){n.exports=r.p+"assets/img/2Dim_to_1Dim_1.2cf9c60f.jpg"},211:function(n,e,r){n.exports=r.p+"assets/img/2Dim_to_1Dim_2.3e0b956f.jpg"},239:function(n,e,r){"use strict";r.r(e);var t=r(0),o=Object(t.a)({},(function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("p",[n._v("今天主要学习了如何通过VBA将二维表转换成为一维表。先不急着讲学到了什么方法和代码，我觉得关于二维表和一维表的定义就可以先来讲一讲。\n"),t("img",{attrs:{src:r(210),alt:"enter image description here"}}),n._v("\n可以看出二维表与一维表有很大的不同，二维表中每个数据都对应着两个字段名称，而一维表中值对应自己这一行的数据。简单说，看二维表总要纵看一次横看一次，而一维表只用横着看一次就行。")]),n._v(" "),t("p",[n._v("在《三张表格走天下》中我读到过小蚊子老师这样的总结，做数据分析需要三张表，一张是"),t("code",[n._v("参数表")]),n._v("，一张是"),t("code",[n._v("录入表")]),n._v("，最后一张是"),t("code",[n._v("透视表")]),n._v("。其中包括最多的原始数据的"),t("code",[n._v("录入表")]),n._v("就要采用一维表格的形式。为什么呢？因为一维表格更加的简单，更加适合采用筛选、排序等方法对数据进行提取和加工。")]),n._v(" "),t("p",[n._v("一维数据表在数据分析的工作中有重要的作用，但是普通人似乎更习惯二维表，因为生活中见得最多的还是二维表。如何进行转换呢？我们的思路是：\n"),t("img",{attrs:{src:r(211),alt:"enter image description here"}}),n._v("\n其中"),t("code",[n._v("字段一")]),n._v("和"),t("code",[n._v("字段二")]),n._v("都是标题名称，所以"),t("code",[n._v("字段一")]),n._v("我们固定列，按行递增来取用并赋值给一维表，对于"),t("code",[n._v("字段二")]),n._v("我们选择固定行，按列递增来提取并赋值。中间的数据"),t("code",[n._v("字段三")]),n._v("则选择利用双层循环的遍历方式来进行提取和赋值。")]),n._v(" "),t("p",[n._v("我们使用以下代码来实现我们的思路：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('Sub 二维表转一维表()\n\nDim arr\nDim rw\nDim col\nDim brr\nDim n\nDim i\nDim j\n\narr = ActiveSheet.UsedRange\nrw = ActiveSheet.UsedRange.Rows.Count\ncol = ActiveSheet.UsedRange.Columns.Count\n\n\'转换过程\nReDim brr(1 To rw * col, 1 To 3)\nn = 2\nFor i = 2 To rw\n    For j = 2 To col\n        brr(n, 1) = arr(i, 1)\n        brr(n, 2) = arr(1, j)\n        brr(n, 3) = arr(i, j)\n        n = n + 1\n    Next j\nNext i\n\n\'补齐字段名\nbrr(1, 1) = "地区"\nbrr(1, 2) = "操作系统"\nbrr(1, 3) = "使用人数"\n\n\'新建表格储存转换结果\nSheets.Add.Name = "转换结果"\nSheets("转换结果").Range(Cells(1, 1), Cells(n - 1, 3)) = brr\n\n\nEnd Sub\n')])])]),t("p",[n._v("可能有人不明白为什么不直接创建一个新表提取赋值给新表的单元格，却要选择先赋值个一个中间数列"),t("code",[n._v("brr")]),n._v("。我想，这个原因大概是因为对单元格直接进行操作比较慢，并且写出的代码也会相对更加繁琐，所以先创建一个新的数列，最后一次性赋值，这样程序的速度会更快。（在处理的表格数据量和数量越来越大的时候这种优势就会越来越明显）")])])}),[],!1,null,null,null);e.default=o.exports}}]);