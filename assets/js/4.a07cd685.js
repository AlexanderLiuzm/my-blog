(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{207:function(e,n,r){e.exports=r.p+"assets/img/one_to_many_1.743b3bc0.jpg"},208:function(e,n,r){e.exports=r.p+"assets/img/one_to_many_2.3ddcc237.jpg"},209:function(e,n,r){e.exports=r.p+"assets/img/one_to_many_3.db963b84.jpg"},210:function(e,n,r){e.exports=r.p+"assets/img/one_to_many_4.021cac1d.jpg"},238:function(e,n,r){"use strict";r.r(n);var t=r(0),o=Object(t.a)({},(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[e._v("与之前的二维表转换成一维表相似，这次将一对多的数据转换成一位表格也是遍历数据然后添加在新的工作表中。")]),e._v(" "),t("p",[e._v("首先，我们要有一个概念，一对多数据表到底长什么样？\n"),t("img",{attrs:{src:r(207),alt:"enter image description here"}}),e._v("\n接着我们讲一下思路，这一次与二维表的区别主要在于在"),t("code",[e._v("号码")]),e._v("和"),t("code",[e._v("城市")]),e._v("后面的"),t("code",[e._v("套餐")]),e._v("不是仅仅只有一个，而是一个号码对应着多个"),t("code",[e._v("套餐")]),e._v("，有的号码对应的"),t("code",[e._v("套餐")]),e._v("没有那么多，它后面的单元格就有空缺。所以我们选择遍历所有的"),t("code",[e._v("套餐")]),e._v("单元格，对单元格的内容进行判断，如果是空单元格，那么该号码没有"),t("code",[e._v("套餐2")]),e._v("或者"),t("code",[e._v("套餐3")]),e._v("，就不用管它，如果该单元格有数据，那就选择在新的工作表中加入一行，并在"),t("code",[e._v("套餐")]),e._v("写入该套餐对应的"),t("code",[e._v("号码")]),e._v("和"),t("code",[e._v("城市")]),e._v("，组成一维数据表。\n"),t("img",{attrs:{src:r(208),alt:"enter image description here"}}),e._v(" "),t("img",{attrs:{src:r(209),alt:"enter image description here"}}),e._v("\n先贴上这次的代码：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('Sub 一对多转一维()\n\narr = ActiveSheet.UsedRange\nrw = UBound(arr, 1)\ncol = UBound(arr, 2)\n\nReDim brr(1 To rw * (col - 2), 1 To 3)\nn = 2\nFor i = 2 To rw\n    For j = 3 To col\n        If Cells(i, j) <> "" Then\n            brr(n, 1) = arr(i, 1)\n            brr(n, 2) = arr(i, 2)\n            brr(n, 3) = arr(i, j)\n            n = n + 1\n        End If\n    Next j\nNext i\n\nbrr(1, 1) = "号码"\nbrr(1, 2) = "城市"\nbrr(1, 3) = "套餐"\n\nSheets.Add.Name = "转换结果"\nSheets("转换结果").Range(Cells(1, 1), Cells(n - 1, 3)) = brr\n\nEnd Sub\n\n')])])]),t("p",[e._v("讲一讲其中和上一次二维表转换相比不同的地方，其中主要加入了一次判断和"),t("code",[e._v("UBound")]),e._v("。\n"),t("code",[e._v("UBound")]),e._v("指的是选取数组的"),t("code",[e._v("上标")]),e._v("，数组中最小值是数组的"),t("code",[e._v("下标")]),e._v("，"),t("code",[e._v("上标")]),e._v("则恰好相反。\n"),t("img",{attrs:{src:r(210),alt:"enter image description here"}})])])}),[],!1,null,null,null);n.default=o.exports}}]);