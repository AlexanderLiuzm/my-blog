(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{203:function(v,_,o){v.exports=o.p+"assets/img/first_vba_program.d4d29c31.jpg"},234:function(v,_,o){"use strict";o.r(_);var t=o(0),s=Object(t.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("p",[v._v("之前的课程中仅仅是对录制的代码进行微小改动，这节课中将用之前学到"),t("code",[v._v("对象")]),v._v("，"),t("code",[v._v("方法")]),v._v("和"),t("code",[v._v("属性")]),v._v("编写第一份VBA代码。")]),v._v(" "),t("h1",{attrs:{id:"情景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#情景"}},[v._v("#")]),v._v(" 情景")]),v._v(" "),t("p",[v._v("文件夹中有"),t("strong",[v._v("三个Excel文件")]),v._v("，它们各自包含若干"),t("strong",[v._v("工作表")]),v._v("，每个工作表有若干行"),t("strong",[v._v("数据")]),v._v("。现在要把每个工作表中的单元格复制到一份新的工作表中，由上到下依次排列。")]),v._v(" "),t("p",[t("img",{attrs:{src:o(203),alt:"场景描述"}})]),v._v(" "),t("h1",{attrs:{id:"操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#操作"}},[v._v("#")]),v._v(" 操作")]),v._v(" "),t("p",[v._v("我们要用VBA实现的操作如下：")]),v._v(" "),t("ol",[t("li",[t("strong",[v._v("选中第一个Excel文件")])]),v._v(" "),t("li",[t("strong",[v._v("选中文件中的第一张工作表")])]),v._v(" "),t("li",[v._v("选择工作表中有内容的单元格")]),v._v(" "),t("li",[v._v("复制粘贴到新的工作表中")]),v._v(" "),t("li",[t("strong",[v._v("再选中第二张工作表")])]),v._v(" "),t("li",[v._v("选择工作表中有内容的单元格")]),v._v(" "),t("li",[v._v("复制粘贴到新的工作表中")]),v._v(" "),t("li",[v._v("……")]),v._v(" "),t("li",[v._v("第一个文件全部复制完后，"),t("strong",[v._v("选择第二个Excel文件")])]),v._v(" "),t("li",[t("strong",[v._v("选中文件中的第一张工作表")])]),v._v(" "),t("li",[v._v("选择工作表中有内容的单元格")]),v._v(" "),t("li",[v._v("复制粘贴到新的工作表中")]),v._v(" "),t("li",[t("strong",[v._v("再选中第二张工作表")])]),v._v(" "),t("li",[v._v("……")])]),v._v(" "),t("p",[v._v("如此循环往复，一直到把三张表中的单元格全部复制到新表格中为止。")]),v._v(" "),t("h1",{attrs:{id:"分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分析"}},[v._v("#")]),v._v(" 分析")]),v._v(" "),t("p",[v._v("在操作中可以看到有很多步骤是完全一样的（选择单元格可以用"),t("code",[v._v("UsedRange")]),v._v("这个对象，所以就不看做一个变量了），其中有少数几个变量：")]),v._v(" "),t("ol",[t("li",[v._v("选中的Excel文件（工作簿）")]),v._v(" "),t("li",[v._v("选中的工作表")]),v._v(" "),t("li",[v._v("第三个很容易忘记，粘贴到新工作表的时候要粘贴在之前的数据下方，所以新表格中"),t("strong",[v._v("开始粘贴的单元格")]),v._v("也是变量")])]),v._v(" "),t("p",[v._v("由此，我们可以设置三个循环：")]),v._v(" "),t("ol",[t("li",[v._v("依次调用工作簿")]),v._v(" "),t("li",[v._v("依次调用工作表")]),v._v(" "),t("li",[v._v("选中上次粘贴结束的下一行单元格")])]),v._v(" "),t("h1",{attrs:{id:"代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#代码"}},[v._v("#")]),v._v(" 代码")]),v._v(" "),t("p",[v._v("以下是对编辑的这份代码的详细注释（"),t("code",[v._v("'")]),v._v("后面的是注释）：")]),v._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[v._v("Sub combin()\n'为新的工作簿设定新的变量\n    Set newbook = Workbooks.Add\n    '将新的工作簿保存在当前工作簿同个文件夹内，并命名为“合并结果”\n    newbook.SaveAs (ThisWorkbook.Path & \"\\合并结果.xlsx\")\n    '遍历所有的工作簿-一级循环\n    For i = 1 To Workbooks.Count\n        '对除了新建的工作簿以外的工作簿进行处理\n        If Workbooks(i).Name <> newbook.Name Then\n            '对选取的工作簿内的工作表进行依次引用-二级循环\n            For j = 1 To Workbooks(i).Worksheets.Count\n                '把所有有内容的单元格复制到新文件中\n                Workbooks(i).Worksheets(j).UsedRange.Copy newbook.Worksheets(1).Range(\"A\" & 1 + r)\n                '清点经过粘贴后空行从哪一行起始，并赋值给r\n                r = newbook.Worksheets(1).UsedRange.Rows.Count\n            Next j\n        End If\n    Next i\nEnd Sub\n")])])]),t("h1",{attrs:{id:"错误总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#错误总结"}},[v._v("#")]),v._v(" 错误总结")]),v._v(" "),t("p",[v._v("我在编写这份代码的时候出现了两处错误，导致运行的时候出现错误：")]),v._v(" "),t("ol",[t("li",[v._v("在第13行中错把"),t("code",[v._v("newbook")]),v._v("打成"),t("code",[v._v("newbooks")]),v._v("，之后再编写代码的时候要注意自己命名的变量，名字就算只打错一个字也会导致程序错误")]),v._v(" "),t("li",[v._v("在第14行中的"),t("code",[v._v("Worksheets")]),v._v("后面忘记加"),t("code",[v._v("(1)")]),v._v("，这样VBA就无法识别到底要数哪个工作表中的行数，导致程序无法运行")])]),v._v(" "),t("blockquote",[t("p",[v._v("这是闻叨在网易云课堂上学习 方骥老师 的VBA课程的动手笔记，以上侵删")])])])}),[],!1,null,null,null);_.default=s.exports}}]);