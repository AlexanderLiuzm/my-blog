(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{240:function(e,a,t){"use strict";t.r(a);var s=t(0),r=Object(s.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"前期工作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前期工作"}},[e._v("#")]),e._v(" 前期工作")]),e._v(" "),t("p",[e._v("先利用"),t("code",[e._v("录制宏")]),e._v("来获取最基础的"),t("code",[e._v("去除重复项")]),e._v("的语句")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('ActiveSheet.Range("$A$1:$F$968").RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5, 6) _, Header:=xlYes\n')])])]),t("p",[e._v("获取到的这个语句块中的对象还是静态的，并不能自动适应任意一个表格，为任意一个表格进行删除重复项，因此我们要对上述的代码块进行改造。")]),e._v(" "),t("h1",{attrs:{id:"确定要改造的对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#确定要改造的对象"}},[e._v("#")]),e._v(" 确定要改造的对象")]),e._v(" "),t("p",[e._v("先观察这这行代码，发现其中的对象有两个——")]),e._v(" "),t("ol",[t("li",[e._v("range-"),t("code",[e._v('Range("$A$1:$F$968")')])]),e._v(" "),t("li",[e._v("Array-"),t("code",[e._v("Columns:=Array(1, 2, 3, 4, 5, 6) _")])])]),e._v(" "),t("p",[e._v("所以我们就想办法改造这两个对象，以达到让宏代码自己适应不同的数据表并且进行重复项删除。")]),e._v(" "),t("p",[e._v("下面是经过改造后得到的宏代码，"),t("code",[e._v("'")]),e._v("后面的是注释")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Sub 宏1()\n'\n' 宏1 宏\n'\n\nDim arr()\n'声明i\nDim i As Integer\n'声明数列的总量\nReDim arr(0 To ActiveSheet.UsedRange.Columns.Count - 1)\n'从第一行到最后一行开始循环，自动检测并建立一个包含所有数据列的数组\nFor i = 0 To ActiveSheet.UsedRange.Columns.Count - 1\n    arr(i) = i + 1\nNext i\n'删除重复项的语句\n'对象是有数据的单元格\n'对这些单元格用RemoveDuplicates方法\n'后面的对象是列\n    Range(ActiveSheet.UsedRange.Address).RemoveDuplicates arr, Header:=xlYes\nEnd Sub\n")])])]),t("h2",{attrs:{id:"对range对象的改造"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#对range对象的改造"}},[e._v("#")]),e._v(" 对Range对象的改造")]),e._v(" "),t("p",[e._v("首先需要明白的是Range这个对象主要用于确定执行查找重复项的具体范围，即"),t("strong",[e._v("要进行删除重复项的那个表格是从第几行第几列到第几行第几列")]),e._v("。所以我们可以用"),t("code",[e._v("Usedrange")]),e._v("作为一个对象，在一个表格中所有含有数据的单元格我们都认为是要进行校验的对象。又因为进行方法的对象是一个数据表的具体区域，所以应该用"),t("code",[e._v("Address")]),e._v("对象。")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Range(ActiveSheet.UsedRange.Address)\n")])])]),t("h2",{attrs:{id:"对array对象的改造"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#对array对象的改造"}},[e._v("#")]),e._v(" 对Array对象的改造")]),e._v(" "),t("p",[e._v("这段代码中的"),t("code",[e._v("Array")]),e._v("对象主要是确认这个表格有几列，即有多少个字段。我们要创立一个新的数组，利用一个循环来对这个数组进行定义，让它变成一个动态数组。")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("For i = 0 To ActiveSheet.UsedRange.Columns.Count - 1\n    arr(i) = i + 1\nNext i\n")])])]),t("p",[e._v("如果想让"),t("code",[e._v("i")]),e._v("从1开始，写成下面这样行不行呢？")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("For i = 1 To ActiveSheet.UsedRange.Columns.Count\n    arr(i) = i\nNext i\n")])])]),t("p",[e._v("经过我的实验，，是不行的，大概是因为VBA默认是要从0开始的，反正记住这个规则就好了。")]),e._v(" "),t("h2",{attrs:{id:"改造完成的代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#改造完成的代码"}},[e._v("#")]),e._v(" 改造完成的代码")]),e._v(" "),t("p",[e._v("经过上述的两个步骤完成的代码是这样子的")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Dim arr()\n\nDim i As Integer\n\nReDim arr(0 To ActiveSheet.UsedRange.Columns.Count - 1)\n\nFor i = 0 To ActiveSheet.UsedRange.Columns.Count - 1\n    arr(i) = i + 1\nNext i\n\nActiveSheet.Range(ActiveSheet.UsedRange.Address).RemoveDuplicates Columns:=arr, Header:=xlYes\n")])])]),t("p",[e._v("但是如果真的尝试在VBA中运行这段代码，Excel会提示代码有错误存在。这是为什么呢？")]),e._v(" "),t("p",[e._v("第一个错误是"),t("code",[e._v("Range")]),e._v("前面有"),t("code",[e._v("ActiveSheet")]),e._v("明显属于重复，后面的括号中已经规定了对象的范围是"),t("code",[e._v("ActiveSheet")]),e._v("中的"),t("code",[e._v("Usedrange")]),e._v("，前面就不用再定义"),t("code",[e._v("ActiveSheet")]),e._v("，删除即可。")]),e._v(" "),t("p",[e._v("第二个错误是"),t("code",[e._v("arr")]),e._v("前面有"),t("code",[e._v("Columns:=")]),e._v("。"),t("code",[e._v("arr")]),e._v("的定义中包含"),t("code",[e._v("ActiveSheet.UsedRange.Columns")]),e._v("，所以前面的"),t("code",[e._v("Columns:=")]),e._v("也是属于多余的。当然这两个错误的原理是我的猜测，具体为什么我也不甚清楚，我就用我自己猜测的两个原理来辅助记忆这个语法规则。")]),e._v(" "),t("blockquote",[t("p",[e._v("这是闻叨在网易云课堂上学习 方骥老师 的VBA课程的动手笔记，以上侵删")])])])}),[],!1,null,null,null);a.default=r.exports}}]);