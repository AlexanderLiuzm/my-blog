(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{220:function(a,e,t){a.exports=t.p+"assets/img/batch_replace_1.7ad1ab38.jpg"},221:function(a,e,t){a.exports=t.p+"assets/img/batch_replace_original.662707f6.png"},222:function(a,e,t){a.exports=t.p+"assets/img/batch_replace_dict.a1fe3244.png"},223:function(a,e,t){a.exports=t.p+"assets/img/batch_replace_target.fbadaebf.png"},224:function(a,e,t){a.exports=t.p+"assets/img/batch_replace_2.40019dab.jpg"},225:function(a,e,t){a.exports=t.p+"assets/img/batch_replace_3.77d72c1a.jpg"},226:function(a,e,t){a.exports=t.p+"assets/img/batch_replace_4.af1651f4.jpg"},244:function(a,e,t){"use strict";t.r(e);var r=t(0),s=Object(r.a)({},(function(){var a=this,e=a.$createElement,r=a._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[r("h2",{attrs:{id:"目标"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#目标"}},[a._v("#")]),a._v(" 目标")]),a._v(" "),r("p",[a._v("把单元格字符串中不完整的部分改成对应的完整部分\n"),r("img",{attrs:{src:t(220),alt:"转换示意"}})]),a._v(" "),r("p",[a._v("原始的文档的C列中有很多是不完整的字符串")]),a._v(" "),r("p",[r("img",{attrs:{src:t(221),alt:"原始"}})]),a._v(" "),r("p",[a._v("我们要通过对应的表格把不完整的字符串补充完整，有的后面加“版”，有的后面加“型”。")]),a._v(" "),r("p",[r("img",{attrs:{src:t(222),alt:"对应目录"}})]),a._v(" "),r("p",[a._v("最后得到类似这样的表格")]),a._v(" "),r("p",[r("img",{attrs:{src:t(223),alt:"目标"}})]),a._v(" "),r("h2",{attrs:{id:"思路"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#思路"}},[a._v("#")]),a._v(" 思路")]),a._v(" "),r("h3",{attrs:{id:"双层循环法"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#双层循环法"}},[a._v("#")]),a._v(" 双层循环法")]),a._v(" "),r("p",[a._v("很多次的VBA课中都用到了双层循环法，这次当然也会第一个想到双层循环法，一个循环套在“数据”表格里，一个套在“条件”表格里，找到对应的字符串，并将其进行替换。")]),a._v(" "),r("h3",{attrs:{id:"替换法"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#替换法"}},[a._v("#")]),a._v(" 替换法")]),a._v(" "),r("p",[a._v('我们也可以直接利用替换的方法进行操作，直接按"Ctrl+H"，把"标准"替换成"标准型"，但是这样就会出现还有"标准型型"的单元格。之后我们可以在进行一次替换，把"型型"和"版版"替换成"型"和"版"。')]),a._v(" "),r("h2",{attrs:{id:"实战"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#实战"}},[a._v("#")]),a._v(" 实战")]),a._v(" "),r("h3",{attrs:{id:"双层循环法-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#双层循环法-2"}},[a._v("#")]),a._v(" 双层循环法")]),a._v(" "),r("h4",{attrs:{id:"变量赋值"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#变量赋值"}},[a._v("#")]),a._v(" 变量赋值")]),a._v(" "),r("p",[a._v("因为我们的循环语句当中经常要用到最大行号这个数值，所以我们先把两张工作表的最大行号都进行提取出来赋值给两个简短的变量"),r("code",[a._v("rw1")]),a._v("和"),r("code",[a._v("rw2")]),a._v("。")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v('rw1 = ActiveSheet.UsedRange.Rows.Count\nrw2 = Sheets("条件").UsedRange.Rows.Count\n')])])]),r("p",[a._v("之后我们把两个数据表中的数据提取出来，赋值给数组，这样就不用一次一次定位工作表当中的单元格。我们把这些数据分别赋值给两个变量"),r("code",[a._v("arr1")]),a._v("和"),r("code",[a._v("arr2")])]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v('arr1 = ActiveSheet.Range("C1:C" & rw1).Value\narr2 = Sheets("条件").Range("A1:B" & rw2).Value\n')])])]),r("h4",{attrs:{id:"循环语句"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#循环语句"}},[a._v("#")]),a._v(" 循环语句")]),a._v(" "),r("p",[a._v("两张工作表中的数据都是从第"),r("strong",[a._v("2")]),a._v("行开始的，所以我们建立两个循环都"),r("strong",[a._v("从2开始，分别到两个表格的最大行号为止")]),a._v("。")]),a._v(" "),r("h4",{attrs:{id:"判断语句"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#判断语句"}},[a._v("#")]),a._v(" 判断语句")]),a._v(" "),r("p",[a._v("我们要找到两个表格当中的对应量，这里的话可以判断"),r("strong",[a._v("数据表格")]),a._v("当中的"),r("code",[a._v("C")]),a._v("列字符串中是否包含"),r("strong",[a._v("条件表格")]),a._v("中的"),r("code",[a._v("A")]),a._v("列中的不完整字符串，然后把它替换成"),r("strong",[a._v("条件表格")]),a._v("中对应的"),r("code",[a._v("B")]),a._v("列字符串。这里会用到一个函数"),r("code",[a._v("InStr()")]),a._v(" "),r("img",{attrs:{src:t(224),alt:"Instr函数"}})]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("For i = 2 To rw1\n    For j = 2 To rw2\n        If InStr(arr1(i, 1), arr2(j, 1)) Then\n            arr1(i, 1) = Replace(arr1(i, 1), arr2(j, 1), arr2(j, 2))\n        End If\n    Next j\nNext i\n")])])]),r("p",[a._v("但是这个判断语句有个问题，即使字符串是完整的，也会被判断为包含"),r("strong",[a._v("条件表格")]),a._v("当中"),r("code",[a._v("A")]),a._v("列的不完整字符串，这样就会出现诸如"),r("em",[a._v("尊享版版、标准型型")]),a._v("这种奇怪的东西。所以我们要再改进一下判断语句，让VBA判断如果"),r("strong",[a._v("数据表格")]),a._v("中的"),r("code",[a._v("C")]),a._v("列字符串包含"),r("strong",[a._v("条件表格")]),a._v("中的"),r("code",[a._v("B")]),a._v("列的字符串，即完整的字符串，就不进行替换操作。")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("If InStr(arr1(i, 1), arr2(j, 1)) And Not (InStr(arr1(i, 1), arr2(j, 2))) Then\n")])])]),r("h4",{attrs:{id:"替换"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#替换"}},[a._v("#")]),a._v(" 替换")]),a._v(" "),r("p",[a._v("终于到了最后一步了，只要把对应的字符串进行替换就好了，这里要用到一个函数"),r("code",[a._v("Replace()")]),a._v(" "),r("img",{attrs:{src:t(225),alt:"Replace函数"}})]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v('ActiveSheet.Range("C1:C" & rw1).Value = arr1\n')])])]),r("h4",{attrs:{id:"完整代码"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#完整代码"}},[a._v("#")]),a._v(" 完整代码")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v('Sub 双层循环法()\n\nDim rw1, rw2\nDim arr1, arr2\nDim i, j\n\nrw1 = ActiveSheet.UsedRange.Rows.Count\nrw2 = Sheets("条件").UsedRange.Rows.Count\n\narr1 = ActiveSheet.Range("C1:C" & rw1).Value\narr2 = Sheets("条件").Range("A1:B" & rw2).Value\n\nFor i = 2 To rw1\n    For j = 2 To rw2\n        If InStr(arr1(i, 1), arr2(j, 1)) And Not (InStr(arr1(i, 1), arr2(j, 2))) Then\n            arr1(i, 1) = Replace(arr1(i, 1), arr2(j, 1), arr2(j, 2))\n        End If\n    Next j\nNext i\n\nActiveSheet.Range("C1:C" & rw1).Value = arr1\n\nMsgBox ("替换完成")\n\nEnd Sub\n')])])]),r("h3",{attrs:{id:"查找替换法"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#查找替换法"}},[a._v("#")]),a._v(" 查找替换法")]),a._v(" "),r("h4",{attrs:{id:"变量赋值-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#变量赋值-2"}},[a._v("#")]),a._v(" 变量赋值")]),a._v(" "),r("p",[a._v("同上，我们可以精简代码，这次我们需要三个变量"),r("code",[a._v("rw1")]),a._v("，"),r("code",[a._v("rw2")]),a._v("和"),r("code",[a._v("arr")])]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v('rw1 = ActiveSheet.UsedRange.Rows.Count\nrw2 = Sheets("条件").UsedRange.Rows.Count\narr = Sheets("条件").Range("A1:B" & rw2).Value\n')])])]),r("h4",{attrs:{id:"替换-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#替换-2"}},[a._v("#")]),a._v(" 替换")]),a._v(" "),r("p",[a._v("循环语句只有一层，非常简单，就和第一次的替换操作一起说吧。这里我们需要让"),r("em",[a._v("数据表")]),a._v("按照"),r("em",[a._v("条件表")]),a._v("的对应关系来进行替换，没法直接用简单的"),r("em",[a._v("替换操作")]),a._v("+"),r("em",[a._v("录制宏")]),a._v("来实现。这里我们还是要用到"),r("code",[a._v("Replace")]),a._v("，但是是"),r("code",[a._v("Replace")]),a._v("方法，语法有些许不同。\n"),r("img",{attrs:{src:t(226),alt:"Replace方法"}})]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v('For i = 2 To rw2\n    Range("C1:C" & rw1).Replace what:=arr(i, 1), Replacement:=arr(i, 2)\nNext i\n')])])]),r("h4",{attrs:{id:"二次替换"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#二次替换"}},[a._v("#")]),a._v(" 二次替换")]),a._v(" "),r("p",[a._v('经过一次替换我们会的到很多带有两个"版"和两个"型"的单元格，这里我们再用一次'),r("code",[a._v("Replace")]),a._v("方法进行替换。")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v('Range("C1:C" & rw1).Replace what:="版版", Replacement:="版"\nRange("C1:C" & rw1).Replace what:="型型", Replacement:="型"\n')])])]),r("h4",{attrs:{id:"完整代码-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#完整代码-2"}},[a._v("#")]),a._v(" 完整代码")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v('Sub 查找替换法()\n\nDim rw1, rw2, arr\n\nrw1 = ActiveSheet.UsedRange.Rows.Count\nrw2 = Sheets("条件").UsedRange.Rows.Count\narr = Sheets("条件").Range("A1:B" & rw2).Value\n\nFor i = 2 To rw2\n    Range("C1:C" & rw1).Replace what:=arr(i, 1), Replacement:=arr(i, 2)\nNext i\n\nRange("C1:C" & rw1).Replace what:="版版", Replacement:="版"\nRange("C1:C" & rw1).Replace what:="型型", Replacement:="型"\n\nMsgBox ("替换完成")\n\nEnd Sub\n')])])])])}),[],!1,null,null,null);e.default=s.exports}}]);